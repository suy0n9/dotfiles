---
- hosts: localhost
  connection: local
  gather_facts: no
  become: no
  vars:
    homebrew_taps:
      - caskroom/cask
      - caskroom/fonts
    homebrew_packages:
      - readline
      - openssl
      - python
      - pyenv
      - ansible
      - git
      - mercurial
      - zsh
      - wget
      - w3m
      - curl
      - tree
      - mysql
      - sqlite
      - redis
      - ghq
      - peco
      - gibo
      - fzf
      - ag
    homebrew_cask_packages:
      - alfred
      - iterm2
      - karabiner-elements
      - firefox
      - google-chrome
      - google-japanese-ime
      - adobe-reader
      - java
      - skype
      - kindle
      - slack
      - skitch
      - boostnote
      - visual-studio-code
      - virtualbox
      - sequel-pro
      - docker
      - font-hack-nerd-font

  tasks:
    - name: add homebrew tap repository
      homebrew_tap: 
        name: "{{ homebrew_taps }}"
        state: "present"

    # update homebrew
    - name: brew update
      homebrew: 
        update_homebrew: yes

    # homebrew
    - name: install homebrew package
      homebrew: 
        name: "{{ homebrew_packages }}"
        state: "present"

    # homebrew-cask
    - name: install homebrew-cask package
      homebrew_cask:
        name: "{{ homebrew_cask_packages }}"
        state: "present"
        install_options: "appdir=/Applications"
      ignore_errors: yes

    # finder defaults
    - name: finder show all files
      osx_defaults:
        domain: com.apple.finder
        key: AppleShowAllFiles
        type: bool
        value: true
        state: present
      notify: Restart Finder

    - name: finder show all extensions
      osx_defaults:
        domain: com.apple.finder
        key: AppleShowAllExtensions
        type: bool
        value: true
        state: present
      notify: Restart Finder

    - name: finder show pathbar
      osx_defaults:
        domain: com.apple.finder
        key: ShowPathbar
        type: bool
        value: true
        state: present
      notify: Restart Finder

    - name: finder show status bar
      osx_defaults:
        domain: com.apple.finder
        key: ShowStatusBar
        type: bool
        value: true
        state: present
      notify: Restart Finder

    # dock defaults
    - name: dock tilesize
      osx_defaults:
        domain: com.apple.dock
        key: tilesize
        type: int
        value: 30
        state: present
      notify: Restart Dock

    - name: dock orientation left
      osx_defaults:
        domain: com.apple.dock
        key: orientation
        type: string
        value: left
        state: present
      notify: Restart Dock

    - name: dock magnification
      osx_defaults:
        domain: com.apple.dock
        key: magnification
        type: bool
        value: true
        state: present
      notify: Restart Dock

    - name: dock auto hide
      osx_defaults:
        domain: com.apple.dock
        key: autohide
        type: int
        value: 1
        state: present
      notify: Restart Dock

  handlers:
      - name: run fc-cache
        shell: fc-cache -vf
